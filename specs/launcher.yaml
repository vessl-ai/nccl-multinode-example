name: nccl-launcher
import:
  /dataset/: volume://vessl-storage/120k-alpaca
  /repo:
    git:
      url: github.com/vessl-ai/test-nccl.git
      ref: main
      credential_name: vessl-ai
export:
  /output/: volume://vessl-storage
resources:
  cluster: vessl-eu-h100-80g-sxm
  preset: gpu-h100-80g-xlarge
image: quay.io/vessl-ai/torch:2.3.1-cuda12.1-r5
run: /repo/finetune/run.sh

env:
  NUM_NODES: "2"
  GPUS_PER_NODE: "8"
  RDZV_ID: some_uniq_id
  ROLE: launcher
